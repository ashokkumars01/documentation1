{% extends "!layout.html" %}

{% block sidebar2 %}
{{ super() }}

<script>
  fetch("/versions.json")
    .then(response => response.json())
    .then(versions => {
      const current = window.location.pathname.split("/")[1];
      const selector = document.createElement("select");
      selector.style.margin = "1em 0";
      selector.onchange = () => {
        const version = selector.value;
        const path = window.location.pathname.split("/").slice(2).join("/");
        window.location.href = "/" + version + "/" + path;
      };

      versions.forEach(v => {
        const option = document.createElement("option");
        option.value = v.name;
        option.textContent = v.name;
        if (v.name === current) {
          option.selected = true;
        }
        selector.appendChild(option);
      });

      document.querySelector("div.sphinxsidebarwrapper").prepend(selector);
    });
</script>
{% endblock %}
