{% extends "!layout.html" %}

{% block footer %}
  {{ super() }}

  <!-- ðŸ”» Version Switcher UI + Script -->
  <div class="version-switcher" style="position: fixed; top: 10px; right: 20px; z-index: 9999;">
    <span id="rst-current-version" style="cursor: pointer; background: #f0f0f0; padding: 6px 10px; border-radius: 4px;">
      Version â–¼
    </span>
    <ul id="version-list" style="list-style: none; margin: 0; padding: 0; display: none; background: white; border: 1px solid #ccc; border-radius: 4px; position: absolute; right: 0; top: 30px;">
    </ul>
  </div>

  <script>
    fetch("/versions.json")
      .then(response => response.json())
      .then(data => {
        const versionList = document.getElementById("version-list");
        const currentPath = window.location.pathname;

        data.forEach(v => {
          const li = document.createElement("li");
          const a = document.createElement("a");
          a.href = v.url;
          a.textContent = v.version;
          a.style.display = "block";
          a.style.padding = "8px 12px";
          a.style.textDecoration = "none";
          a.style.color = "#333";
          a.onmouseover = () => a.style.background = "#f5f5f5";
          a.onmouseout = () => a.style.background = "white";

          if (currentPath.startsWith(v.url)) {
            a.style.fontWeight = "bold";
          }

          li.appendChild(a);
          versionList.appendChild(li);
        });

        document.getElementById("rst-current-version").addEventListener("click", () => {
          versionList.style.display = versionList.style.display === "none" ? "block" : "none";
        });

        window.addEventListener("click", (e) => {
          if (!e.target.closest(".version-switcher")) {
            versionList.style.display = "none";
          }
        });
      });
  </script>
{% endblock %}
